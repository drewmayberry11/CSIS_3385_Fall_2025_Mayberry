<!--
  Project: Form Security and Validation (Project 3)
  File: form.html
  Author: Drew Mayberry
  Course: CSIS 3385 – Database & Web Vulnerabilities
  Date: 2025-11-02
  Summary: Improved version of the provided form.
           - Uses a valid POST method (HTML forms support GET/POST)
           - Correct input types, required, and constraints
           - Visible password field
           - Labels and IDs connected
           - Message limited to 10 words (JS)
  Notes: Client-side checks are for UX; server must re-validate/sanitize.
-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Submit User Info</title>
        <!-- keep the existing stylesheet -->
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <div class="form-container">
            <h2>Create User</h2>

            <!-- HTML forms only support GET or POST. DELETE is NOT valid in <form>.
       Using POST; servers that need DELETE usually use a hidden method override. -->
            <form action="/inventory/search" method="POST" id="secure-form"
                novalidate autocomplete="on">

                <!-- Optional but recommended: semantic grouping improves a11y and clarity -->
                <fieldset>
                    <legend>Account</legend>

                    <!-- Proper label for id hookup; type=text enables browser features and mobile keyboards.
           Constraints reduce junk input -->
                    <label for="username">Username</label>
                    <input
                        type="text"
                        id="username"
                        name="username"
                        placeholder="e.g., wolf_99"
                        autocomplete="username"
                        required
                        minlength="3"
                        maxlength="20"
                        pattern="^[A-Za-z0-9_]{3,20}$"
                        aria-describedby="username-hint" />
                    <!-- brief inline hint (UX); not security by itself -->
                    <small id="username-hint">3–20 chars: letters, numbers,
                        underscore.</small>

                    <!-- Make password viible and functional (not pushed off-screen).
           Basic strength rule via minlength; maxlength avoids absurd payloads. -->
                    <label for="password">Password</label>
                    <input
                        type="password"
                        id="password"
                        name="password"
                        placeholder="8+ characters"
                        autocomplete="new-password"
                        required
                        minlength="8"
                        maxlength="128" />
                </fieldset>

                <fieldset>
                    <legend>Profile</legend>

                    <!-- Age should be numeric. min/max provide simple client-side bounds. -->
                    <label for="age">Age</label>
                    <input
                        type="number"
                        id="age"
                        name="age"
                        placeholder="e.g., 29"
                        inputmode="numeric"
                        required
                        min="13"
                        max="120" />

                    <!-- Email should be type=email so the browser can validate the basic shape.
           maxlength prevents extremely long inputs. -->
                    <label for="email">Email</label>
                    <input
                        type="email"
                        id="email"
                        name="email"
                        placeholder="you@example.com"
                        autocomplete="email"
                        required
                        maxlength="254" />
                </fieldset>

                <fieldset>
                    <legend>Message</legend>

                    <!-- “10 words or less”: enforced with JS on submit.
           maxlength is a soft cap to discourage novels; server must still validate. -->
                    <label for="message">Message (10 words or less)</label>
                    <textarea
                        id="message"
                        name="message"
                        placeholder="Keep it short and sweet."
                        rows="3"
                        required
                        maxlength="500"
                        aria-describedby="message-help message-error"></textarea>
                    <small id="message-help">Limit: 10 words. We’ll check on
                        submit.</small>
                    <!-- Accessible, live-updating error region -->
                    <div id="message-error" role="alert" aria-live="polite"
                        style="display:none;"></div>
                </fieldset>

                <button type="submit">Submit</button>
            </form>
        </div>

        <script>
  // --- Word-limit enforcement (10 words) ---
  // Using safe DOM APIs (no innerHTML) per secure-DOM.
  (function () {
    const form = document.getElementById('secure-form');
    const message = document.getElementById('message');
    const errorBox = document.getElementById('message-error');

    function wordCount(s) {
      // Trim + split on runs of whitespace; ignore empty results
      const m = s.trim().match(/\S+/g);
      return m ? m.length : 0;
    }

    form.addEventListener('submit', function (e) {
      const words = wordCount(message.value);
      if (words > 10) {
        // Prevent navigation; give clear, accessible feedback.
        e.preventDefault();
        errorBox.textContent = `Your message has ${words} words. Please limit to 10 or fewer.`;
        errorBox.style.display = 'block';
        message.focus();
      } else {
        errorBox.textContent = '';
        errorBox.style.display = 'none';
      }
    });
  }());
</script>
    </body>
</html>
